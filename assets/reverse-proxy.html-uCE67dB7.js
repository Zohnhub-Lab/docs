import{_ as l,a as d,b as c,c as p,d as h}from"./bt_reverse_proxy-dl3bNKaD.js";import{_ as u,r as o,o as _,c as v,b as e,e as n,a,w as r,f as i}from"./app--VcHmvhe.js";const m={},f=e("h1",{id:"reverse-proxy",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#reverse-proxy","aria-hidden":"true"},"#"),n(" Reverse proxy")],-1),b=e("code",null,"reverse proxy",-1),g={class:"hint-container tip"},x=e("p",{class:"hint-container-title"},"Missing https or port / Can't Play video when reverse-proxy non-standard ports or enable https?",-1),k={href:"https://github.com/alist-org/alist/issues/726",target:"_blank",rel:"noopener noreferrer"},y={href:"https://github.com/alist-org/alist/issues/1159",target:"_blank",rel:"noopener noreferrer"},w={href:"https://github.com/alist-org/alist/issues/2429",target:"_blank",rel:"noopener noreferrer"},S={href:"https://github.com/alist-org/alist/issues/3644",target:"_blank",rel:"noopener noreferrer"},R={href:"https://github.com/alist-org/alist/issues/4181",target:"_blank",rel:"noopener noreferrer"},A={href:"https://github.com/alist-org/alist/issues/4719",target:"_blank",rel:"noopener noreferrer"},N=i(`<h3 id="nginx" tabindex="-1"><a class="header-anchor" href="#nginx" aria-hidden="true">#</a> <strong>nginx</strong></h3><p>Add in the server field of the website configuration file</p><div class="language-nginx line-numbers-mode" data-ext="nginx"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> X-Forwarded-For <span class="token variable">$proxy_add_x_forwarded_for</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> X-Forwarded-Proto <span class="token variable">$scheme</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> Host <span class="token variable">$http_host</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> X-Real-IP <span class="token variable">$remote_addr</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> Range <span class="token variable">$http_range</span></span><span class="token punctuation">;</span>
	  <span class="token directive"><span class="token keyword">proxy_set_header</span> If-Range <span class="token variable">$http_if_range</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_redirect</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_pass</span> http://127.0.0.1:5244</span><span class="token punctuation">;</span>
    <span class="token comment"># the max size of file to upload</span>
    <span class="token directive"><span class="token keyword">client_max_body_size</span> <span class="token number">20000m</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),P={class:"hint-container warning"},I=e("p",{class:"hint-container-title"},"Note",-1),L={href:"http://bt.cn",target:"_blank",rel:"noopener noreferrer"},q=e("ul",null,[e("li",null,"location ~ ^/(.user.ini|.htaccess|.git|.svn|.project|LICENSE|README.md"),e("li",null,"location ~ .*.(gif|jpg|jpeg|png|bmp|swf)$"),e("li",null,"location ~ .*.(js|css)?$")],-1),E=i(`<p>Disable Nginx caching in <code>/www/server/nginx/conf/proxy.conf</code> or the corresponding website configuration file. Otherwise, with the default configuration, when accessing large files, Nginx will attempt to cache the remote file locally first, resulting in playback failures.</p><div class="language-conf line-numbers-mode" data-ext="conf"><pre class="language-conf"><code>proxy_cache cache_one; # Remove this line
proxy_max_temp_file_size 0; # Add this line
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="apache" tabindex="-1"><a class="header-anchor" href="#apache" aria-hidden="true">#</a> <strong>Apache</strong></h3><p>Add the anti-generation configuration item ProxyPass under the VirtualHost field, such as:</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VirtualHost</span> <span class="token attr-name"><span class="token namespace">*:</span>80</span><span class="token punctuation">&gt;</span></span>
    ServerName myapp.example.com
    ServerAdmin webmaster@example.com
    DocumentRoot /www/myapp/public

    AllowEncodedSlashes NoDecode
    ProxyPass &quot;/&quot; &quot;http://127.0.0.1:5244/&quot; nocanon
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>VirtualHost</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="caddy" tabindex="-1"><a class="header-anchor" href="#caddy" aria-hidden="true">#</a> <strong>Caddy</strong></h3><p>Add the reverse_proxy configuration item reverse_proxy under the Caddyfile file, for example:</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>:80 {
     reverse_proxy 127.0.0.1:5244
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="demonstration-of-setting-up-reverse-proxy-in-bt-panel" tabindex="-1"><a class="header-anchor" href="#demonstration-of-setting-up-reverse-proxy-in-bt-panel" aria-hidden="true">#</a> <strong>Demonstration of Setting up Reverse Proxy in BT Panel</strong></h2><h4 id="_1-login-to-the-bt-panel-and-add-a-new-website" tabindex="-1"><a class="header-anchor" href="#_1-login-to-the-bt-panel-and-add-a-new-website" aria-hidden="true">#</a> 1.Login to the BT panel and add a new website.</h4><p><img src="`+l+'" alt="bt_new_website"></p><h4 id="_2-modify-the-website-settings" tabindex="-1"><a class="header-anchor" href="#_2-modify-the-website-settings" aria-hidden="true">#</a> 2.Modify the website settings.</h4><p><img src="'+d+'" alt="bt_new_website_01"></p><h4 id="_3-remove-the-default-panel-code" tabindex="-1"><a class="header-anchor" href="#_3-remove-the-default-panel-code" aria-hidden="true">#</a> 3.Remove the default panel code.</h4><p><img src="'+c+'" alt="bt_delete_default_config_01"></p><p><img src="'+p+'" alt="bt_delete_default_config_02"></p><h4 id="_4-add-the-reverse-proxy" tabindex="-1"><a class="header-anchor" href="#_4-add-the-reverse-proxy" aria-hidden="true">#</a> 4.Add the reverse proxy.</h4><p><img src="'+h+'" alt="bt_reverse_proxy"></p><blockquote><p>If you need to apply for an <code>SSL certificate</code>, you can first apply for the certificate in the <code>SSL</code> option, and then set up the reverse proxy. Alternatively, you can set up the reverse proxy first, disable the proxy function, apply for an <code>SSL</code> certificate, and then enable the proxy again.</p></blockquote>',19);function $(V,C){const t=o("RouterLink"),s=o("ExternalLinkIcon");return _(),v("div",null,[f,e("p",null,[n("The program listens to port 5244 by default. If you do "),b,n(", recommended you set "),a(t,{to:"/config/configuration.html#site_url"},{default:r(()=>[n("site_url")]),_:1}),n(" so that alist can works fine.")]),e("blockquote",null,[e("p",null,[n("If you want to use a sub folder, refer to "),a(t,{to:"/faq/howto.html#how-to-reverse-proxy-with-sub-directory"},{default:r(()=>[n("reverse proxy with sub folder")]),_:1})])]),e("div",g,[x,e("p",null,[n("You need to passed correct host header, refer to "),e("a",k,[n("#726"),a(s)]),n(),e("a",y,[n("#1159"),a(s)]),n(),e("a",w,[n("#2429"),a(s)]),n(),e("a",S,[n("#3644"),a(s)]),n(),e("a",R,[n("#4181"),a(s)]),n(),e("a",A,[n("#4719"),a(s)])])]),N,e("div",P,[I,e("p",null,[n("If you use the "),e("a",L,[n("bt.cn"),a(s)]),n(", be sure to delete the following default configuration")]),q]),E])}const j=u(m,[["render",$],["__file","reverse-proxy.html.vue"]]);export{j as default};
